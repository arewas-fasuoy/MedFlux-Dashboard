<!DOCTYPE html>
<html lang="english">
  <head>
    <title>AddDoctor - exported project</title>
    <meta property="og:title" content="AddDoctor - exported project" />
    <meta id="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta property="twitter:card" content="summary_large_image" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <style data-tag="reset-style-sheet">
      html {  line-height: 1.15;}body {  margin: 0;}* {  box-sizing: border-box;  border-width: 0;  border-style: solid;}p,li,ul,pre,div,h1,h2,h3,h4,h5,h6,figure,blockquote,figcaption {  margin: 0;  padding: 0;}button {  background-color: transparent;}button,input,optgroup,select,textarea {  font-family: inherit;  font-size: 100%;  line-height: 1.15;  margin: 0;}button,select {  text-transform: none;}button,[type="button"],[type="reset"],[type="submit"] {  -webkit-appearance: button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner {  border-style: none;  padding: 0;}button:-moz-focus,[type="button"]:-moz-focus,[type="reset"]:-moz-focus,[type="submit"]:-moz-focus {  outline: 1px dotted ButtonText;}a {  color: inherit;  text-decoration: inherit;}input {  padding: 2px 4px;}img {  display: block;}html { scroll-behavior: smooth  }
    </style>
    <style data-tag="default-style-sheet">
      html {
        font-family: Inter;
        font-size: 16px;
      }

      body {
        font-weight: 400;
        font-style:normal;
        text-decoration: none;
        text-transform: none;
        letter-spacing: normal;
        line-height: 1.15;
        color: var(--dl-color-gray-black);
        background-color: var(--dl-color-gray-white);

      }
    </style>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&amp;display=swap"
      data-tag="font"
    />
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <div>
      <link href="./add-doctor.css" rel="stylesheet" />

      <div class="add-doctor-container">
        <div class="add-doctor-desktop1">
          <img
            alt="conflux1114"
            src="public/playground_assets/conflux1114-6mx-1500w.png"
            class="add-doctor-conflux1"
          />
          <div class="add-doctor-rectangle4">
            <input
              type="text"
              id="doctor_name"
              placeholder="Enter Doctor Name"
              class="add-doctor-textinput input"
            />
            <input
              type="text"
              id="doctor_email"
              placeholder="Enter Doctor Email"
              class="add-doctor-textinput1 input"
            />
            <input
              type="text"
              id="doctor_contact"
              placeholder="Enter Doctor Contact"
              class="add-doctor-textinput2 input"
            />
            <input
              type="text"
              id="doctor_location"
              placeholder="Enter Doctor Contact"
              class="add-doctor-textinput3 input"
            />
            <input
              type="text"
              id="doctor_hospital"
              placeholder="Enter Doctor Hospital"
              class="add-doctor-textinput4 input"
            />
            <input
              type="text"
              id="doctor_age"
              placeholder="Enter Doctor Age"
              class="add-doctor-textinput5 input"
            />
            <input
              type="text"
              id="doctor_qualification"
              placeholder="Enter Doctor Qualification"
              class="add-doctor-textinput6 input"
            />
            <input
              type="text"
              id="doctor_specialization"
              placeholder="Doctor Weight Specialization"
              class="add-doctor-textinput7 input"
            />
            <div class="add-doctor-container1">
              <div class="add-doctor-container2">
                <span class="add-doctor-text">Doctor&nbsp; Name:</span>
                <span class="add-doctor-text01">Email:</span>
                <span class="add-doctor-text02">Contact:</span>
                <span class="add-doctor-text03">Location:</span>
                <span class="add-doctor-text04">
                  <span>Hospital:</span>
                  <br />
                </span>
                <span class="add-doctor-text07">Doctor Age:</span>
                <span class="add-doctor-text08">Qualification:</span>
                <span class="add-doctor-text09">Specialization:</span>
              </div>
            </div>
            <h1 class="add-doctor-text10">
              <span>Add Doctor</span>
              <br />
            </h1>
            <a
              href="admin.html"
              id="cancel_doctor"
              class="add-doctor-navlink button"
            >
              <span class="add-doctor-text13">
                <span>&nbsp;&nbsp;&nbsp; Cancel &nbsp;&nbsp; &nbsp;</span>
                <br />
              </span>
            </a>
            <a href="#" class="add-doctor-button button" id="add_doctor_btn">Add Doctor</a>
          </div>
          <span class="add-doctor-text19"><span>MedFlux</span></span>
          <div class="add-doctor-rectangle1"></div>
          <a href="home.html" class="add-doctor-text21"><span>MedFlux</span></a>
          <a
            href="https://arewasfasuoy.wordpress.com/contact/"
            target="_blank"
            rel="noreferrer noopener"
            class="add-doctor-text23"
          >
            <span>Feedback</span>
          </a>
          <a
            href="https://arewasfasuoy.wordpress.com/contact/"
            target="_blank"
            rel="noreferrer noopener"
            class="add-doctor-text25"
          >
            <span>Contact Me</span>
          </a>
          <a
            href="https://arewasfasuoy.wordpress.com"
            target="_blank"
            rel="noreferrer noopener"
            class="add-doctor-text27"
          >
            <span>Blog</span>
          </a>
          <div class="add-doctor-rectangle3"></div>
          <span class="add-doctor-text29">
            <span>
              Copyright @ 2023, MedFlux Health care System - All Rights Reserved
            </span>
          </span>
        </div>
      </div>
    </div>
    <!-- <script src="https://unpkg.com/browserfs"></script> -->
    <script src="https://requirejs.org/docs/release/2.3.6/minified/require.js"></script>
    <script>
      // Get id
       // Get the current URL
      var currentUrl = window.location.href;
      // Extract the value of the argument "username"
      var argName = "id";
      var argValue = "";
      if (currentUrl.indexOf("?") > -1) {
          var params = currentUrl.split("?")[1].split("&");
          for (var i = 0; i < params.length; i++) {
              var param = params[i].split("=");
              if (param[0] == argName) {
                  argValue = decodeURIComponent(param[1]);
                  console.log("Received ID:",argValue);
                  break;
              }
          }
      }

      function writeTo(conn, content){

        const arg1 = conn;
        const arg2 = content;
        // Retrieve existing data from local storage
        let existingData = localStorage.getItem('fileData') || '';

        // Append new data to the existing data
        existingData += content;

        // Store the updated data back to local storage
        localStorage.setItem('fileData', existingData);
        console.log("Written competed");
      }
      function addDoctor() {
            // Get the doctor values from the input fields
            var doctor_name = document.getElementById("doctor_name").value;
            var doctor_email = document.getElementById("doctor_email").value;
            var doctor_age = document.getElementById("doctor_age").value;
            var doctor_contact = document.getElementById("doctor_contact").value;
            var doctor_qualification = document.getElementById("doctor_qualification").value;
            var doctor_location = document.getElementById("doctor_location").value;
            var doctor_specialization = document.getElementById("doctor_specialization").value;
            var doctor_hospital = document.getElementById("doctor_hospital").value;

            console.log(doctor_name);
            console.log(doctor_email);
            console.log(doctor_age);
            console.log(doctor_contact);
            console.log(doctor_qualification);
            console.log(doctor_location);
            console.log(doctor_specialization);
            console.log(doctor_hospital);
            //
            var conn = atob("aHR0cHM6Ly9pcGZzLmlvL2lwZnMvUW1UYlp1VkZza3Q5dUMydlNBQzNBNVJvcUt6NEQ2RXkyd1VCbjV2WHZ2QjFodD9maWxlbmFtZT1kb2N0b3JzX2RhdGEuY3N2");          
            var content = doctor_name+","+"12345"+","+"1212"+","+doctor_age+","+doctor_location+","+doctor_email+","+doctor_qualification+","+doctor_specialization+","+doctor_contact+","+doctor_hospital+"\n";
            console.log(conn);

            fetch('http://127.0.0.1:5000/add_doctor', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },

            body: JSON.stringify({
              "username":doctor_name,
              "password":"12345",
              "id":"12898",
              "age":doctor_age,
              "location":doctor_location,
              "email":doctor_email,
              "qualification":doctor_qualification,
              "specilization":doctor_specialization,
              "content":doctor_contact,
              "hospital":doctor_hospital
              }
            ),
          })
            .then(response => response.json())
            .then(data => {
              // Handle the response data
              console.log(data);
              document.getElementById("doctor_name").value = '';
              document.getElementById("doctor_email").value= '';
              document.getElementById("doctor_age").value= '';
              document.getElementById("doctor_contact").value= '';
              document.getElementById("doctor_qualification").value= '';
              document.getElementById("doctor_location").value= '';
              document.getElementById("doctor_specialization").value= '';
              document.getElementById("doctor_hospital").value= '';
              alert("Docetor added successfully...");
              window.location.href = "admin.html?id="+encodeURIComponent(argValue);
              })
              .catch(error => {
                // Handle any errors
                console.error('Error:', error);
              });

            // // Step 1: Retrieve the existing CSV file from IPFS
            // ipfsClient.cat(existingCID)
            //   .then(existingContent => {
            //     // Step 2: Convert the content to a readable format
            //     const existingData = existingContent.toString(); // Assuming the existing content is a string

            //     // Step 3: Add the new row to the existing content
            //     const updatedData = existingData + newDataRow.join(',') + '\n';

            //     // Step 4: Convert the updated content back to CSV format
            //     const csvStringifier = csvWriter();
            //     const updatedCSVContent = csvStringifier.getHeaderString() + updatedData;

            //     // Step 5: Update the file in IPFS with the modified content
            //     ipfsClient.add(updatedCSVContent)
            //       .then(updatedFiles => {
            //         const updatedCID = updatedFiles[0].cid.toString();
            //         console.log('CSV file updated in IPFS. New CID:', updatedCID);
            //       })
            //       .catch(error => {
            //         console.error('Error updating CSV file in IPFS:', error);
            //       });
            //   })
            //   .catch(error => {
            //     console.error('Error retrieving existing CSV file from IPFS:', error);
            //   });


        }
      document.getElementById("add_doctor_btn").addEventListener("click", async function() {
        addDoctor();
    });
    </script>
  </body>
</html>
